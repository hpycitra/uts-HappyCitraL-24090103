<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Total Products - Universitas Harkat Negeri</title>
    <style>
        /* CSS DARI KODE SEBELUMNYA TIDAK BERUBAH */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center; 
            align-items: center;
            min-height: 100vh; 
            color: #333;
            background-color: #f0f0f0; 
        }

        .dashboard-wrapper {
            display: flex;
            width: 800px; 
            height: 90vh; 
            max-height: 900px; 
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden; 
        }
        
        /* SIDEBAR (Tanpa Sorotan) */
        .sidebar {
            width: 100px;
            background-color: #f8f8f8; 
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1); 
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 80px; 
            position: static; 
            height: 100%;
            z-index: 10;
        }

        .sidebar a {
            padding: 2px 0; 
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            text-decoration: none;
            width: 100%;
            transition: background-color 0.3s;
            box-sizing: border-box; 
        }
        
        .sidebar a:hover {
            background-color: #eeeeee; 
        }

        .sidebar .icon {
            width: 80px; 
            height: 80px;
            filter: grayscale(100%) opacity(0.5); 
            transition: opacity 0.3s, filter 0.3s;
        }
        
        .sidebar a:hover .icon {
            opacity: 1; 
            filter: none; 
        }

        .sidebar a.active-link {
            background-color: #eeeeee; 
            padding-top: 2px; 
            padding-bottom: 2px; 
            border-left: 5px solid #4a4a4a; 
            margin-left: -5px;
            width: calc(100% + 5px); 
        }
        
        .sidebar a.active-link .icon {
            filter: none; 
            opacity: 1; 
        }
        /* END SIDEBAR */

        /* MAIN CONTENT */
        .main-content {
            flex-grow: 1;
            padding: 30px;
            background-color: #fff; 
            overflow-y: auto; 
            box-shadow: none; 
        }
        
        .header {
            margin-bottom: 30px;
            /* DIUBAH: Mengatur header agar bisa menampung tombol di kanan */
            display: flex; 
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin: 0;
        }

        /* CONTENT BARU UNTUK HALAMAN DETAIL */
        .main-content-area {
            padding: 0;
            background: none;
            box-shadow: none;
        }

        /* Search input */
        .search-container {
            margin-bottom: 20px;
        }
        
        .search-container input {
            width: 100%; 
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            box-sizing: border-box; 
        }

        /* TABLE STYLING */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0; 
            border: 1px solid #ddd; 
        }

        th, td {
            padding: 12px;
            border: 1px solid #ddd; 
            text-align: left;
            font-size: 14px;
        }

        th {
            background: #f8f8f8;
            font-weight: bold;
            color: #555;
            text-transform: uppercase;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* Button Styling */
        .btn {
            padding: 4px 8px; 
            font-size: 12px; 
            font-weight: 500;
            text-transform: uppercase;
            border-radius: 4px;
            cursor: pointer;
            border: none;
            color: black; /* Diubah: Warna teks menjadi hitam agar terlihat di latar abu-abu */
            margin: 0 2px; 
            background: #bdc3c7; /* Diubah: Abu Terang untuk Edit/Delete */
        }

        /* Kelas .edit dan .delete tidak perlu lagi mendefinisikan background */
        .edit {
             /* background: #2ecc71;  Hijau */
             /* background: #bdc3c7; */
             color: white; /* Biarkan teks putih untuk kontras yang lebih baik pada abu terang */
        }

        .delete {
             /* background: #e74c3c;  Merah */
             /* background: #bdc3c7; */
             color: white; /* Biarkan teks putih untuk kontras yang lebih baik pada abu terang */
        }
        
        /* Scroll area untuk tabel */
        .scroll-area {
            max-height: calc(90vh - 180px); 
            overflow-y: auto;
        }

        /* --- CSS BARU UNTUK MODAL TAMBAH PRODUK --- */
        .add-product-btn {
            background-color: #bdc3c7; /* Diubah: Abu Terang */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .add-product-btn:hover {
            background-color: #95a5a6; /* Diubah: Abu Sedikit Lebih Gelap untuk hover */
        }
        
        .modal {
            display: none; 
            position: fixed; 
            z-index: 20; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.4); 
            padding-top: 60px;
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; 
            padding: 20px;
            border: 1px solid #888;
            width: 80%; 
            max-width: 400px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .form-submit-btn {
            background-color: #bdc3c7; /* Diubah: Abu Terang */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }

        .form-submit-btn:hover {
            background-color: #95a5a6; /* Diubah: Abu Sedikit Lebih Gelap untuk hover */
        }
    </style>
</head>
<body>

    <div class="dashboard-wrapper">
        <div class="sidebar">
            <a href="dashboard.html" title="Dashboard"> 
                <img src="assets/image/home.png" alt="Dashboard Icon" class="icon"/>
            </a>
            <a href="products.html" title="Data Produk"> 
                <img src="assets/image/dataproduk.png" alt="Products Icon" class="icon"/>
            </a>
            <a href="penjualan.html" title="Penjualan">
                <img src="assets/image/penjualan.png" alt="Sales Icon" class="icon"/>
            </a>
            <a href="laporan.html" title="Laporan">
                <img src="assets/image/laporan.png" alt="Reports Icon" class="icon"/>
            </a>
            <a href="pengaturan.html" title="Pengaturan">
                <img src="assets/image/pengaturan.png" alt="Settings Icon" class="icon"/>
            </a>
        </div>

        <div class="main-content">
            <div class="header">
                <h1 id="totalProductsHeader">Total Products (120)</h1> 
                <button id="addProductBtn" class="add-product-btn">Tambah Produk Baru</button>
            </div>

            <div class="main-content-area">

                <div class="search-container">
                    <input type="text" id="search" placeholder="Cari produk...">
                </div>

                <div class="scroll-area">
                    <table id="productsTable">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama Produk</th>
                                <th>Stok</th>
                                <th>Harga Jual</th>
                                <th>Kategori</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>Tambah Produk Baru</h2>
            <form id="productForm">
                <div class="form-group">
                    <label for="productName">Nama Produk:</label>
                    <input type="text" id="productName" name="productName" required>
                </div>
                <div class="form-group">
                    <label for="productStock">Stok:</label>
                    <input type="number" id="productStock" name="productStock" required min="0">
                </div>
                <div class="form-group">
                    <label for="productPrice">Harga Jual (Rupiah):</label>
                    <input type="number" id="productPrice" name="productPrice" required min="1000">
                </div>
                <div class="form-group">
                    <label for="productCategory">Kategori:</label>
                    <select id="productCategory" name="productCategory" required>
                        <option value="Kopi">Kopi</option>
                        <option value="Teh">Teh</option>
                        <option value="Susu">Susu</option>
                        <option value="Coklat">Coklat</option>
                        <option value="Jus & Smoothie">Jus & Smoothie</option>
                        <option value="Minuman Segar">Minuman Segar</option>
                        <option value="Lainnya">Lainnya</option>
                    </select>
                </div>
                <button type="submit" class="form-submit-btn">Simpan Produk</button>
            </form>
        </div>
    </div>
    <script>
    const tableBody = document.getElementById("productsTable").getElementsByTagName('tbody')[0];
    const headerTitle = document.getElementById('totalProductsHeader');
    
    // Inisialisasi counter dan total produk dari kode asli
    let TOTAL_PRODUCTS = 120;
    let counter = 1;

    // --- FUNGSI ASLI (TIDAK BERUBAH) ---
    function formatRupiah(number) {
        return new Intl.NumberFormat('id-ID', {
            style: 'currency',
            currency: 'IDR',
            minimumFractionDigits: 0
        }).format(number);
    }
    
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    const logicalProducts = [
        { category: "Kopi", names: ["Kopi Latte", "Cappuccino", "Espresso", "Kopi Susu Gula Aren", "Americano", "Macchiato", "Piccolo", "Affogato", "Mocha Latte", "Kopi Hitam", "Kopi Lemon", "Kopi Karamel", "Kopi Vanilla", "Kopi Hazelnut", "Espresso Tonic", "Ice Shaken Espresso", "Cold Brew", "Flat White", "Gibraltar", "Lungo", "Ristretto", "Kopi Blend", "Kopi Rempah", "Kopi Pandan", "Kopi Kelapa"], priceRange: [20000, 35000] },
        { category: "Teh", names: ["Es Teh Manis", "Teh Lemon", "Es Teh Leci", "Teh Tarik", "Matcha Latte", "Es Thai Tea", "Teh Oolong", "Teh Hijau", "Teh Rosela", "Teh Jahe", "Teh Madu", "Es Teh Peach", "Teh Earl Grey", "Teh Mint", "Teh Rempah", "Teh Susu", "Teh Original", "Teh Hitam Pekat", "Teh Herbal", "Teh Kombucha"], priceRange: [15000, 25000] },
        { category: "Susu", names: ["Susu Vanilla", "Susu Coklat", "Susu Full Cream", "Susu Madu", "Susu Kurma", "Susu Almond", "Susu Kedelai", "Susu Dingin", "Susu Panas", "Susu Karamel", "Susu Tiramisu", "Susu Matcha", "Susu Taro", "Susu Mint", "Susu Strawberry"], priceRange: [18000, 28000] },
        { category: "Coklat", names: ["Coklat Panas", "Ice Blend Coklat", "Coklat Hazelnut", "Coklat Mint", "Coklat Swiss", "Coklat Belgia", "Coklat Klasik", "Coklat Susu", "Coklat Karamel", "Coklat Pedas", "Coklat Alpukat", "Coklat Durian", "Coklat Original", "Coklat Spesial", "Coklat Hitam"], priceRange: [25000, 38000] },
        { category: "Jus & Smoothie", names: ["Jus Mangga", "Jus Alpukat", "Jus Jeruk", "Smoothie Strawberry", "Smoothie Pisang", "Smoothie Buah Naga", "Jus Nanas", "Jus Tomat", "Jus Wortel", "Smoothie Mangga"], priceRange: [22000, 32000] },
        { category: "Minuman Segar", names: ["Air Mineral", "Soda Lemon", "Mocktail Sunset", "Ice Blend Taro", "Ice Blend Vanilla", "Ice Blend Red Velvet", "Air Kelapa Murni", "Jus Apel", "Jus Semangka", "Es Krim Soda", "Sirup Leci", "Sirup Markisa", "Minuman Rempah", "Minuman Energi", "Soda Susu", "Squash Jeruk", "Squash Leci", "Jus Kiwi", "Jus Anggur", "Air Hangat", "Air Dingin", "Lemonade", "Mojito Klasik", "Mojito Leci", "Sparkling Water", "Infused Water Lemon", "Infused Water Berry", "Sirup Mawar", "Soda Gembira", "Minuman Ginseng", "Jus Jambu", "Jus Melon", "Jus Belimbing", "Minuman Beras Kencur", "Es Cendol"], priceRange: [8000, 35000] }
    ];

    function getAllUniqueBeverageProducts() {
        let allProducts = [];
        logicalProducts.forEach(cat => {
            cat.names.forEach(name => {
                const minPrice = cat.priceRange[0];
                const maxPrice = cat.priceRange[1];
                const price = Math.round((Math.random() * (maxPrice - minPrice) + minPrice) / 1000) * 1000;
                
                allProducts.push({
                    name: name,
                    category: cat.category,
                    price: price,
                    stock: Math.floor(Math.random() * 150) + 1 
                });
            });
        });
        shuffleArray(allProducts); 
        return allProducts;
    }

    // Fungsi untuk menambah baris produk ke tabel (DIUBAH agar bisa dipanggil dari form)
    function addProductRow(product) {
        let row = tableBody.insertRow();
        // Nomor urut diambil dari jumlah total baris + 1
        const rowNumber = tableBody.rows.length; 
        
        row.innerHTML = `
            <td>${rowNumber}</td>
            <td>${product.name}</td>
            <td>${product.stock}</td>
            <td>${formatRupiah(product.price)}</td>
            <td>${product.category}</td>
            <td>
                <button class="btn edit">Edit</button>
                <button class="btn delete">Delete</button>
            </td>
        `;

        // Update TOTAL_PRODUCTS dan header
        TOTAL_PRODUCTS = rowNumber;
        headerTitle.textContent = `Total Products (${TOTAL_PRODUCTS})`;
    }

    // --- PENGISIAN DATA AWAL (120 PRODUK) ---
    const requiredProducts = [
        {name: "Kopi Gayo", stock: 85, price: 25000, category: "Kopi"},      
        {name: "Teh Hitam", stock: 120, price: 18000, category: "Teh"},      
        {name: "Coklat Aceh", stock: 95, price: 30000, category: "Coklat"},  
    ];

    requiredProducts.forEach(p => {
        let row = tableBody.insertRow();
        row.innerHTML = `
            <td>${counter++}</td>
            <td>${p.name}</td>
            <td>${p.stock}</td>
            <td>${formatRupiah(p.price)}</td>
            <td>${p.category}</td>
            <td>
                <button class="btn edit">Edit</button>
                <button class="btn delete">Delete</button>
            </td>
        `;
    });
    
    let availableProducts = getAllUniqueBeverageProducts();
    const requiredNames = requiredProducts.map(p => p.name);
    availableProducts = availableProducts.filter(p => !requiredNames.includes(p.name));

    const productsToGenerate = availableProducts.slice(0, TOTAL_PRODUCTS - requiredProducts.length);
    
    productsToGenerate.forEach(p => {
        let row = tableBody.insertRow();
        
        row.innerHTML = `
            <td>${counter++}</td>
            <td>${p.name}</td>
            <td>${p.stock}</td>
            <td>${formatRupiah(p.price)}</td>
            <td>${p.category}</td>
            <td>
                <button class="btn edit">Edit</button>
                <button class="btn delete">Delete</button>
            </td>
        `;
    });


    // Fungsi pencarian
    document.getElementById("search").addEventListener("keyup", function() {
        let keyword = this.value.toLowerCase();
        let rows = tableBody.getElementsByTagName("tr");

        for (let i = 0; i < rows.length; i++) {
            if (rows[i].parentNode.tagName.toLowerCase() === 'thead') continue; 
            
            let text = rows[i].innerText.toLowerCase();
            rows[i].style.display = text.includes(keyword) ? "" : "none";
        }
    });

    // --- FUNGSI BARU UNTUK MODAL DAN TAMBAH PRODUK ---
    const modal = document.getElementById("addProductModal");
    const btn = document.getElementById("addProductBtn");
    const span = document.getElementsByClassName("close-btn")[0];
    const form = document.getElementById("productForm");

    // 1. Membuka modal ketika tombol diklik
    btn.onclick = function() {
        modal.style.display = "block";
    }

    // 2. Menutup modal ketika (x) diklik
    span.onclick = function() {
        modal.style.display = "none";
        form.reset(); 
    }

    // 3. Menutup modal ketika di luar area modal diklik
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
            form.reset();
        }
    }

    // 4. Menangani submit form
    form.addEventListener('submit', function(event) {
        event.preventDefault(); 

        const newProduct = {
            name: document.getElementById('productName').value,
            stock: parseInt(document.getElementById('productStock').value),
            price: parseInt(document.getElementById('productPrice').value),
            category: document.getElementById('productCategory').value
        };

        // Tambahkan produk baru ke tabel dan update header
        addProductRow(newProduct); 

        // Tutup modal dan reset form
        modal.style.display = "none";
        form.reset();
        alert(`Produk "${newProduct.name}" berhasil ditambahkan! Total produk sekarang adalah ${TOTAL_PRODUCTS}!`);
    });
</script>

</body>
</html>